<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Menu ‚Äî BOHO Restaurant</title>
  <link rel="stylesheet" href="style.css">
  <style>
        @media (max-width: 600px) {
          .flipbook-viewer {
                height: 120vw;
                min-height: 70vw;
                max-height: 140vw;
          }
          .flipbook-spread {
            flex-direction: column;
            align-items: center;
            width: 100% !important;
            min-width: 0;
          }
          .flipbook-page-container.left,
          .flipbook-page-container.right {
            width: 100% !important;
            max-width: 100vw !important;
            border: none;
            box-shadow: none;
            margin: 0 auto;
          }
          .flipbook-page {
            width: 100% !important;
            height: auto !important;
            max-width: 100vw !important;
            max-height: 110vw !important;
            object-fit: contain;
            display: block;
            margin: 0 auto;
            box-shadow: 0 4px 24px rgba(0,0,0,0.10);
            border-radius: 16px;
          }
          .flipbook-controls {
            flex-direction: row;
            gap: 6px;
            margin-top: 6px;
            justify-content: center;
            align-items: center;
            width: 100%;
            flex-wrap: nowrap;
          }
          .flipbook-info {
            font-size: 13px;
            min-width: unset;
            margin: 0 4px;
            white-space: nowrap;
          }
          .flipbook-btn {
            min-width: 36px;
            padding: 6px 10px;
            font-size: 18px;
            margin: 0;
            border-radius: 8px;
            background: #A89158;
            color: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
          }
          .flipbook-btn span { display: none; }
        }
    html, body { height: 100%; margin: 0; padding: 0; }

    .flipbook-container {
      max-width: 1200px;
      width: 100%;
      margin: 6px auto; /* centered in modal */
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-bottom: 14px; /* add bottom space so modal appears fuller */
    }

    .flipbook-viewer {
      background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
      border-radius: 8px;
      box-shadow: 0 14px 36px rgba(0,0,0,0.20), inset 0 0 12px rgba(255,255,255,0.25);
      overflow: hidden;
      position: relative;
      width: 100%;
      height: calc(100vh - 80px); /* give more vertical room to the viewer */
      max-height: 1100px;
      padding: 0; /* remove inner padding so image can fill */
      display: flex;
      align-items: center;
      justify-content: center;
      perspective: 1200px;
    }

    .flipbook-spread {
      width: 100%;
      height: 100%;
      display: flex;
      position: relative;
      transform-style: preserve-3d;
    }

    /* Single-page flip layer (appears above the right page during forward flip
       and above the left page during backward flip) */
    .page-flip {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      backface-visibility: hidden;
      transform-style: preserve-3d;
      z-index: 50;
    }

    .page-flip .flip-image {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transform-origin: left center;
      backface-visibility: hidden;
      box-shadow: 0 30px 72px rgba(0,0,0,0.36);
      transition: transform 2s cubic-bezier(0.22, 0.61, 0.36, 1);
      transform: rotateY(0deg);
    }

    /* subtle curl overlay applied to the flipping edge */
    .page-flip .curl {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 160px;
      right: 0;
      pointer-events: none;
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.22) 28%, rgba(0,0,0,0.18) 60%, rgba(0,0,0,0.32) 100%);
      transform-origin: left center;
      opacity: 0;
      transition: opacity 0.3s ease, transform 2s cubic-bezier(0.22, 0.61, 0.36, 1);
      filter: blur(2px);
      mix-blend-mode: multiply;
    }

    /* adjust curl placement for backward flips - hinge on right edge */
    .page-flip.backward .curl {
      right: 0;
      left: auto;
      transform-origin: right center;
    }

    /* When flipping backward (left side), hinge on right edge */
    .page-flip.backward .flip-image {
      transform-origin: right center;
    }

    .flipbook-page-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      padding: 0; /* allow image to reach edges */
    }

    .flipbook-page-container.left {
      border-right: 2px solid rgba(0,0,0,0.05);
      box-shadow: inset -5px 0 15px rgba(0,0,0,0.05);
    }

    .flipbook-page-container.right {
      box-shadow: inset 5px 0 15px rgba(0,0,0,0.05);
    }

    .flipbook-page {
      width: 100%;
      height: auto;
      max-width: 100%;
      max-height: 88vh; /* allow image to occupy most of the viewport height */
      object-fit: contain;
      object-position: center;
      display: block;
      margin: 0 auto;
    }

    .flipbook-controls {
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 12px;
      margin-bottom: 22px; /* extra bottom room to push modal fuller */
    }

    .flipbook-btn {
      padding: 12px 24px;
      background: #A89158;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .flipbook-btn:hover:not(:disabled) {
      background: #956f47;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .flipbook-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .flipbook-info {
      text-align: center;
      color: #666;
      font-size: 14px;
      min-width: 120px;
    }

    @media (max-width: 768px) {
      .flipbook-viewer {
        height: 400px;
      }
      
      .flipbook-btn {
        padding: 10px 16px;
        font-size: 13px;
      }
    }

    /* Hide header and footer when in iframe modal */
    .header {
      display: none;
    }

    .footer {
      display: none;
    }

    .content {
      padding-top: 20px;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a href="index.html" class="brand">
        <img src="assets/logo.jpeg" alt="BOHO Logo" class="site-logo">
        <span class="site-title">üçΩÔ∏è BOHO Restaurant</span>
      </a>
      <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
      <nav class="main-nav" id="mainNav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="menu.html">Menu Grid</a></li>
          <li><a href="menu-flipbook.html" class="active">Menu Flipbook</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="reservations.html">Reservations</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="content">
    <div class="inner">
      <h2>Our Menu</h2>

      <div class="flipbook-container">
        <!-- Two-Page Viewer with Flip Animation -->
        <div class="flipbook-viewer" id="flipbookViewer">
          <div class="flipbook-spread" id="flipbookSpread">
            <!-- Left and right pages will be rendered here -->
          </div>
        </div>

        <!-- Controls -->
        <div class="flipbook-controls">
          <button class="flipbook-btn" id="prevBtn" onclick="previousSpread()">&#8592;<span> Previous</span></button>
          <div class="flipbook-info">
            <span id="pageInfo"><span id="currentStart">1</span>-<span id="currentEnd">2</span> / <span id="totalPages">0</span></span>
          </div>
          <button class="flipbook-btn" id="nextBtn" onclick="nextSpread()"><span>Next </span>&#8594;</button>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>&copy; 2025 BOHO Restaurant. All rights reserved.
      <a class="social-link" href="https://www.facebook.com/bohogarden.vn" target="_blank" rel="noopener" aria-label="Facebook">
        <svg viewBox="0 0 24 24"><path d="M22.675 0h-21.35C.595 0 0 .592 0 1.326v21.348C0 23.406.595 24 1.325 24h11.495v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.143v3.24l-1.918.001c-1.504 0-1.797.715-1.797 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116C23.406 24 24 23.406 24 22.674V1.326C24 .592 23.406 0 22.675 0"/></svg>
      </a>
    </p>
    <p><strong>Owner:</strong> Vung Tau &nbsp;|&nbsp; <strong>Phone:</strong> <a href="tel:+84798633339">+84 79 863 3339</a> &nbsp;|&nbsp; <strong>Email:</strong> <a href="mailto:bohobeergarden@gmail.com">bohobeergarden@gmail.com</a></p>
    <p><strong>Address:</strong> 66 Ha Long, Vung Tau, Vietnam 70000</p>
  </footer>

  <script>
    // Flipbook configuration ‚Äî use the numbered images in assets/Menu pages/
    const menuPages = [
      'assets/Menu pages/1.png',
      'assets/Menu pages/2.png',
      'assets/Menu pages/3.png',
      'assets/Menu pages/4.png',
      'assets/Menu pages/5.png',
      'assets/Menu pages/6.png',
      'assets/Menu pages/7.png',
      'assets/Menu pages/8.png',
      'assets/Menu pages/9.png',
      'assets/Menu pages/10.png',
      'assets/Menu pages/11.png',
      'assets/Menu pages/12.png',
      'assets/Menu pages/13.png',
      'assets/Menu pages/14.png',
      'assets/Menu pages/15.png',
      'assets/Menu pages/16.png',
      'assets/Menu pages/17.png',
      'assets/Menu pages/18.png',
      'assets/Menu pages/19.png',
      'assets/Menu pages/20.png',
      'assets/Menu pages/21.png',
      'assets/Menu pages/22.png',
      'assets/Menu pages/23.png',
      'assets/Menu pages/24.png',
      'assets/Menu pages/25.png',
      'assets/Menu pages/26.png',
      'assets/Menu pages/27.png',
      'assets/Menu pages/28.png',
      'assets/Menu pages/29.png',
      'assets/Menu pages/30.png',
      'assets/Menu pages/31.png',
      'assets/Menu pages/32.png',
      'assets/Menu pages/33.png',
      'assets/Menu pages/34.png',
      'assets/Menu pages/35.png',
      'assets/Menu pages/36.png',
      'assets/Menu pages/37.png'
    ];

    let currentSpreadIndex = 0;
    let isFlipping = false;

    function initFlipbook() {
      document.getElementById('totalPages').textContent = menuPages.length;
      renderSpread(0);
      updateControls();
    }

    function renderSpread(spreadIndex) {
      const spread = document.getElementById('flipbookSpread');
      spread.innerHTML = '';
      const isMobile = window.innerWidth <= 600;
      if (isMobile) {
        // Single page view for mobile with turn effect
        const pageIdx = spreadIndex;
        const container = document.createElement('div');
        container.className = 'flipbook-page-container left';
        if (pageIdx < menuPages.length) {
          const img = document.createElement('img');
          img.src = menuPages[pageIdx];
          img.alt = `Page ${pageIdx + 1}`;
          img.className = 'flipbook-page';
          img.onerror = () => console.error(`Failed to load: ${menuPages[pageIdx]}`);
          container.appendChild(img);
        }
        spread.appendChild(container);
        document.getElementById('currentStart').textContent = pageIdx + 1;
        document.getElementById('currentEnd').textContent = pageIdx + 1;
        currentSpreadIndex = pageIdx;
      } else {
        // Two-page view for desktop/tablet
        const leftPageIdx = spreadIndex * 2;
        const rightPageIdx = spreadIndex * 2 + 1;
        // Left page
        const leftContainer = document.createElement('div');
        leftContainer.className = 'flipbook-page-container left';
        if (leftPageIdx < menuPages.length) {
          const leftImg = document.createElement('img');
          leftImg.src = menuPages[leftPageIdx];
          leftImg.alt = `Page ${leftPageIdx + 1}`;
          leftImg.className = 'flipbook-page';
          leftImg.onerror = () => console.error(`Failed to load: ${menuPages[leftPageIdx]}`);
          leftContainer.appendChild(leftImg);
        }
        spread.appendChild(leftContainer);
        // Right page
        const rightContainer = document.createElement('div');
        rightContainer.className = 'flipbook-page-container right';
        if (rightPageIdx < menuPages.length) {
          const rightImg = document.createElement('img');
          rightImg.src = menuPages[rightPageIdx];
          rightImg.alt = `Page ${rightPageIdx + 1}`;
          rightImg.className = 'flipbook-page';
          rightImg.onerror = () => console.error(`Failed to load: ${menuPages[rightPageIdx]}`);
          rightContainer.appendChild(rightImg);
        }
        spread.appendChild(rightContainer);
        document.getElementById('currentStart').textContent = leftPageIdx + 1;
        document.getElementById('currentEnd').textContent = Math.min(rightPageIdx + 1, menuPages.length);
        currentSpreadIndex = spreadIndex;
      }
      updateControls();
    }

    function flipForward() {
      if (isFlipping) return;
      const maxSpreads = Math.ceil(menuPages.length / 2);
      if (currentSpreadIndex >= maxSpreads - 1) return;
      const spread = document.getElementById('flipbookSpread');
      // ensure current spread is visible
      renderSpread(currentSpreadIndex);
      const rightContainer = spread.querySelector('.flipbook-page-container.right');
      const rightImg = rightContainer ? rightContainer.querySelector('img') : null;
      if (!rightImg) {
        renderSpread(currentSpreadIndex + 1);
        return;
      }
      // Create flip layer inside the right container
      const flipLayer = document.createElement('div');
      flipLayer.className = 'page-flip';
      const flipImg = document.createElement('img');
      flipImg.className = 'flip-image';
      flipImg.src = rightImg.src;
      flipImg.alt = rightImg.alt;
      // curl overlay
      const curl = document.createElement('div');
      curl.className = 'curl';
      flipLayer.appendChild(curl);
      flipLayer.appendChild(flipImg);
      rightContainer.appendChild(flipLayer);

      // Disable controls while flipping
      isFlipping = true;
      document.getElementById('prevBtn').disabled = true;
      document.getElementById('nextBtn').disabled = true;

      // Slight initial tilt for realism
      flipImg.style.transform = 'rotateY(0deg) rotateZ(0deg)';
      // animate: rotateY to -180deg with a stronger Z rotation for curl effect
      requestAnimationFrame(() => {
        curl.style.opacity = '1';
        curl.style.transform = 'translateX(0px)';
        flipImg.style.transform = 'rotateY(-180deg) rotateZ(-14deg)';
      });

      // Swap page content quickly (400ms) so change happens early in flip
      const swapTimer = setTimeout(() => {
        if (flipLayer && flipLayer.parentNode) flipLayer.parentNode.removeChild(flipLayer);
        renderSpread(currentSpreadIndex + 1);
      }, 400);

      // Fallback: reset after animation completes to ensure controls re-enable
      const resetTimer = setTimeout(() => {
        clearTimeout(swapTimer);
        if (flipLayer && flipLayer.parentNode) flipLayer.parentNode.removeChild(flipLayer);
        isFlipping = false;
        updateControls();
      }, 2000);
    }

    function flipBackward() {
      if (isFlipping) return;
      if (currentSpreadIndex <= 0) return;
      
      // Capture target index immediately to prevent double-click issue
      isFlipping = true;
      const targetSpreadIndex = currentSpreadIndex - 1;
      
      const spread = document.getElementById('flipbookSpread');
      const leftContainer = spread.querySelector('.flipbook-page-container.left');
      const leftImg = leftContainer ? leftContainer.querySelector('img') : null;
      if (!leftImg) {
        renderSpread(targetSpreadIndex);
        isFlipping = false;
        updateControls();
        return;
      }

      // Hide original left image so flip layer is visible
      leftImg.style.opacity = '0';

      // Create flip layer; backward flip hinges on right edge, flips away to the right
      const flipLayer = document.createElement('div');
      flipLayer.className = 'page-flip backward';
      const flipImg = document.createElement('img');
      flipImg.className = 'flip-image';
      flipImg.src = leftImg.src;
      flipImg.alt = leftImg.alt;
      const curl = document.createElement('div');
      curl.className = 'curl';
      flipLayer.appendChild(curl);
      flipLayer.appendChild(flipImg);
      leftContainer.appendChild(flipLayer);

      // Disable controls while flipping
      document.getElementById('prevBtn').disabled = true;
      document.getElementById('nextBtn').disabled = true;

      // Start visible and flip away to the right
      flipImg.style.transform = 'rotateY(0deg) rotateZ(0deg)';
      requestAnimationFrame(() => {
        curl.style.opacity = '1';
        flipImg.style.transform = 'rotateY(180deg) rotateZ(14deg)';
      });

      // Swap page content quickly (400ms)
      const swapTimer = setTimeout(() => {
        if (flipLayer && flipLayer.parentNode) flipLayer.parentNode.removeChild(flipLayer);
        if (leftImg) leftImg.style.opacity = '1';
        renderSpread(targetSpreadIndex);
      }, 400);

      // Reset after animation completes
      const resetTimer = setTimeout(() => {
        clearTimeout(swapTimer);
        if (flipLayer && flipLayer.parentNode) flipLayer.parentNode.removeChild(flipLayer);
        if (leftImg) leftImg.style.opacity = '1';
        isFlipping = false;
        updateControls();
      }, 2000);
    }

    function nextSpread() {
      if (window.innerWidth <= 600) {
        if (currentSpreadIndex < menuPages.length - 1) {
          // Add turn effect for mobile
          const spread = document.getElementById('flipbookSpread');
          const img = spread.querySelector('.flipbook-page');
          if (img) {
            img.style.transition = 'transform 0.5s cubic-bezier(0.22, 0.61, 0.36, 1)';
            img.style.transform = 'rotateY(-90deg) scale(0.9)';
            setTimeout(() => {
              renderSpread(currentSpreadIndex + 1);
            }, 300);
          } else {
            renderSpread(currentSpreadIndex + 1);
          }
        }
      } else {
        flipForward();
      }
    }

    function previousSpread() {
      if (window.innerWidth <= 600) {
        if (currentSpreadIndex > 0) {
          // Add turn effect for mobile
          const spread = document.getElementById('flipbookSpread');
          const img = spread.querySelector('.flipbook-page');
          if (img) {
            img.style.transition = 'transform 0.5s cubic-bezier(0.22, 0.61, 0.36, 1)';
            img.style.transform = 'rotateY(90deg) scale(0.9)';
            setTimeout(() => {
              renderSpread(currentSpreadIndex - 1);
            }, 300);
          } else {
            renderSpread(currentSpreadIndex - 1);
          }
        }
      } else {
        flipBackward();
      }
    }

    function updateControls() {
      if (window.innerWidth <= 600) {
        document.getElementById('prevBtn').disabled = currentSpreadIndex === 0;
        document.getElementById('nextBtn').disabled = currentSpreadIndex === menuPages.length - 1;
      } else {
        const maxSpreads = Math.ceil(menuPages.length / 2);
        document.getElementById('prevBtn').disabled = currentSpreadIndex === 0;
        document.getElementById('nextBtn').disabled = currentSpreadIndex === maxSpreads - 1;
      }
    }

    // Re-render on resize for responsiveness
    window.addEventListener('resize', function() {
      if (window.innerWidth <= 600) {
        renderSpread(currentSpreadIndex);
      } else {
        renderSpread(Math.floor(currentSpreadIndex / 2));
      }
    });

    // Init on load
    document.addEventListener('DOMContentLoaded', initFlipbook);

    // Navigation toggle for small screens
    const navToggle = document.querySelector('.nav-toggle');
    const mainNav = document.getElementById('mainNav');
    if (navToggle && mainNav) {
      navToggle.addEventListener('click', () => {
        mainNav.classList.toggle('open');
      });
      document.addEventListener('click', (e) => {
        if (!mainNav.contains(e.target) && !navToggle.contains(e.target)) {
          mainNav.classList.remove('open');
        }
      });
    }
  </script>
</body>
</html>
