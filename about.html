<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>About ‚Äî BOHO Resturant</title>
  <link rel="stylesheet" href="style.css?v=20260123">
  <style>
    /* Inline override to ensure gold buttons render immediately on this page */
    .boho-gold-btn, button.boho-gold-btn, input[type="submit"].boho-gold-btn {
      background-color: #A89158 !important;
      color: #fff !important;
      border: 2px solid #A89158 !important;
      border-radius: 5px !important;
      padding: 8px 18px !important;
      cursor: pointer !important;
      font-weight: 500 !important;
      box-shadow: 0 2px 8px rgba(168,145,88,0.13) !important;
    }
    .boho-gold-btn:hover, .boho-gold-btn:focus {
      background-color: #8a7846 !important;
      border-color: #8a7846 !important;
      box-shadow: 0 4px 12px rgba(168,145,88,0.18) !important;
    }
  </style>
</head>
<body class="about-page">
  <!-- Full-Width Video Hero Section (Behind Everything) -->
  <section class="video-hero">
    <video autoplay muted loop playsinline>
      <source src="https://res.cloudinary.com/dhwftrt6y/video/upload/v1768560984/about2viz_vr9tlu.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <div class="video-overlay"></div>
  </section>

  <!-- Header (Transparent, Overlaid on Video) -->
  <header class="header header-transparent">
    <div class="header-content">
      <a href="index.html" class="brand">
        <img src="assets/logo.jpeg" alt="BOHO Logo" class="site-logo">
        <span class="site-title">üçΩÔ∏è BOHO Resturant</span>
      </a>
      <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
      <nav class="main-nav" id="mainNav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="menu.html">Menu</a></li>
          <li><a href="about.html" class="active">About</a></li>
          <li><a href="reservations.html">Reservations</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="content">
    <div class="inner">
      <h2>About Us</h2>
      <p><strong>BOHO Restaurant</strong> is a standout seaside dining destination in the heart of V≈©ng T√†u, where fresh seafood, open and airy spaces, and attentive service come together to create a memorable culinary experience.</p>
      <p>Located at 66 H·∫° Long Street, V≈©ng T√†u Ward, Ho Chi Minh City, BOHO boasts a prime beachfront location, offering a relaxing dining atmosphere with cool sea breezes and expansive ocean views. Our seafood is carefully selected daily from trusted sources to ensure natural freshness, complemented by a diverse menu rich in authentic Vietnamese and Asian flavors.</p>
      <p>The restaurant features multiple spacious halls and flexible event spaces, fully equipped with modern sound and lighting systems as well as LED screens. This allows BOHO to accommodate a wide range of occasions‚Äîfrom individual diners and tour groups to family gatherings, birthday parties, celebrations, gala dinners, and corporate events.</p>
      <p>At BOHO, we believe that a great meal is not only about quality ingredients, but also about a beautiful setting, genuine service, and thoughtful attention to every detail.</p>
      <p><em>BOHO Restaurant ‚Äì Fresh from the sea, perfect in every moment.</em></p>

      <!-- Posts Section -->
      <section class="posts-section">
        <h3>What Our Guests Say</h3>
        <button id="writeReviewBtn" class="boho-gold-btn" style="margin-bottom: 16px;">Write a Review</button>
        <!-- Modal for writing a review -->
        <div id="reviewModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:1000;">
          <div style="background:#fff; padding:24px; border-radius:8px; max-width:400px; width:90%; position:relative;">
            <span id="closeModal" style="position:absolute; top:8px; right:12px; cursor:pointer; font-size:20px;">&times;</span>
            <h4>Write a Review</h4>
            <form id="guestReviewForm">
              <label for="reviewerName">Name:</label><br>
              <input type="text" id="reviewerName" name="reviewerName" required style="width:100%; margin-bottom:8px;"><br>
              <label for="reviewRating">Rating:</label><br>
              <select id="reviewRating" name="reviewRating" required style="width:100%; margin-bottom:8px;">
                <option value="">Select</option>
                <option value="5">5 - Excellent</option>
                <option value="4">4 - Very Good</option>
                <option value="3">3 - Good</option>
                <option value="2">2 - Fair</option>
                <option value="1">1 - Poor</option>
              </select><br>
              <label for="reviewText">Review:</label><br>
              <textarea id="reviewText" name="reviewText" rows="4" required style="width:100%; margin-bottom:8px;"></textarea><br>
              <button type="submit" class="boho-gold-btn" style="width:100%;margin-top:8px;">Submit</button>
            </form>
          </div>
        </div>
        <div id="user-reviews-list"></div>
      </section>

        <!-- Google Reviews (sheet-backed) -->
        <section id="google-reviews" class="reviews-section" style="margin-top:18px;">
          <h3>Google Reviews</h3>
          <div id="reviews-list">Loading Google reviews...</div>
          <div id="gmaps-hidden" style="height:0;width:0;overflow:hidden;"></div>
        </section>

    </div>
  </main>

  <footer class="footer">
    <p>&copy; 2025 BOHO Resturant. All rights reserved.
      <a class="social-link" href="https://www.facebook.com/bohogarden.vn" target="_blank" rel="noopener" aria-label="Facebook">
        <svg viewBox="0 0 24 24"><path d="M22.675 0h-21.35C.595 0 0 .592 0 1.326v21.348C0 23.406.595 24 1.325 24h11.495v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.143v3.24l-1.918.001c-1.504 0-1.797.715-1.797 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116C23.406 24 24 23.406 24 22.674V1.326C24 .592 23.406 0 22.675 0"/></svg>
      </a>
    </p>
    <p><strong>Owner:</strong> Vung Tau &nbsp;|&nbsp; <strong>Phone:</strong> <a href="tel:+84798633339">+84 79 863 3339</a> &nbsp;|&nbsp; <strong>Email:</strong> <a href="mailto:bohobeergarden@gmail.com">bohobeergarden@gmail.com</a></p>
    <p><strong>Address:</strong> 66 Ha Long, Vung Tau, Vietnam 70000</p>
  </footer>

  <script src="app.js"></script>
  <script>
  // --- Guest Reviews Modal and Submission ---
  document.addEventListener('DOMContentLoaded', function () {
    const writeReviewBtn = document.getElementById('writeReviewBtn');
    const reviewModal = document.getElementById('reviewModal');
    const closeModalBtn = document.getElementById('closeModal');
    const reviewForm = document.getElementById('guestReviewForm');
    const userReviewsList = document.getElementById('user-reviews-list');

    // Helper to escape HTML
    function escapeHtml(text) {
      if (!text) return '';
      const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
      return text.replace(/[&<>"']/g, m => map[m]);
    }

    // Fetch and render guest reviews from backend
    async function fetchAndRenderGuestReviews() {
      if (!userReviewsList) return;
      userReviewsList.innerHTML = '<p>Loading guest reviews...</p>';
      try {
        const response = await fetch(`${API_URL}?action=getGuestReviews`);
        const result = await response.json();
        if (!result.success || !Array.isArray(result.data) || result.data.length === 0) {
          userReviewsList.innerHTML = '<p>No guest reviews yet. Be the first to write one!</p>';
          return;
        }
        // Filter, dedupe, sort (latest first) and limit to 8 reviews
        const seen = new Set();
        const processed = (result.data || [])
          .filter(r => {
            const name = (r.name || '').toLowerCase();
            if (name === 'john' || name === 'sara' || name === 'sarah' || name === 'anonymous') return false;
            const ratingNum = parseInt(r.rating, 10) || 0;
            if (ratingNum <= 3) return false; // hide 3 stars and below
            return true;
          })
          .map(r => ({ ...r, _date: r.date || '' }))
          .sort((a, b) => new Date(b._date).getTime() - new Date(a._date).getTime())
          .filter(r => {
            const key = ((r.name || '') + '||' + (r.review || r.text || '') + '||' + (r.date || '')).toLowerCase().trim();
            if (seen.has(key)) return false;
            seen.add(key);
            return true;
          })
          .slice(0, 8);

        if (!processed || processed.length === 0) {
          userReviewsList.innerHTML = '<p>No guest reviews yet. Be the first to write one!</p>';
          return;
        }

        userReviewsList.innerHTML = processed.map(r => {
          const dateStr = r.date ? new Date(r.date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }) : '';
          const ratingNum = parseInt(r.rating, 10) || 0;
          const stars = ratingNum > 0 ? ('‚òÖ'.repeat(ratingNum) + '‚òÜ'.repeat(Math.max(0, 5 - ratingNum))) : '';
          return `
          <div class="review-card">
            <div class="review-header">
              <span class="boho-gold" style="font-weight:bold;">${escapeHtml(r.name)}</span>
              <span class="review-date">${dateStr}</span>
              <span class="review-rating boho-gold" style="font-size:1.2em;">${stars}</span>
            </div>
            <div class="review-text">${escapeHtml(r.review || r.text)}</div>
          </div>
        `;
        }).join('');
      } catch (err) {
        userReviewsList.innerHTML = '<p>Failed to load guest reviews.</p>';
      }
    }

    if (writeReviewBtn && reviewModal) {
      writeReviewBtn.onclick = () => { reviewModal.style.display = 'flex'; };
    }
    if (closeModalBtn && reviewModal) {
      closeModalBtn.onclick = () => { reviewModal.style.display = 'none'; };
    }
    window.onclick = function(event) {
      if (event.target === reviewModal) reviewModal.style.display = 'none';
    };

    if (reviewForm) {
      reviewForm.onsubmit = async function(e) {
        e.preventDefault();
        const name = document.getElementById('reviewerName').value.trim();
        const rating = parseInt(document.getElementById('reviewRating').value, 10);
        const text = document.getElementById('reviewText').value.trim();
        const date = new Date().toISOString().slice(0, 10); // ISO format for backend
        if (!name || !rating || !text) return;
        // Send to Google Sheet via backend (GuestReviews)
        // Use application/x-www-form-urlencoded to avoid CORS preflight on some deployments
        try {
          const params = new URLSearchParams();
          params.append('action', 'addGuestReview');
          params.append('name', name);
          params.append('rating', String(rating));
          params.append('text', text);
          params.append('date', date);

          await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: params.toString()
          });
        } catch (err) { console.error('Failed to submit guest review', err); }
          reviewForm.reset();
        reviewModal.style.display = 'none';
        // Refresh reviews after submission
        fetchAndRenderGuestReviews();
      };
    }
    // Initial render
    fetchAndRenderGuestReviews();
  });
  // GoogleReviews display removed; GuestReviews are shown above.
  </script>

  <script>
  // Fetch and render GoogleReviews (sheet-backed)
  document.addEventListener('DOMContentLoaded', async () => {
    const container = document.getElementById('reviews-list');
    if (!container) return;
    function escapeHtml(text) {
      if (!text) return '';
      const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
      return text.replace(/[&<>"']/g, m => map[m]);
    }
    try {
      const reviews = await apiGet('getGoogleReviews');
      if (!reviews || reviews.length === 0) {
        container.innerHTML = '<p>No Google reviews available.</p>';
        return;
      }
      // Filter out low ratings, dedupe, sort by date desc and limit to 8
      const seenG = new Set();
      const processedG = (reviews || [])
        .filter(r => {
          const ratingNum = parseInt(r.rating, 10) || 0;
          return ratingNum > 3; // show only 4 and 5 star reviews
        })
        .map(r => ({ ...r, _date: r.date || '' }))
        .sort((a, b) => new Date(b._date).getTime() - new Date(a._date).getTime())
        .filter(r => {
          const key = ((r.name || '') + '||' + (r.review || '') + '||' + (r.date || '')).toLowerCase().trim();
          if (seenG.has(key)) return false;
          seenG.add(key);
          return true;
        })
        .slice(0, 8);

      if (processedG.length === 0) {
        container.innerHTML = '<p>No Google reviews available.</p>';
        return;
      }

      function renderStars(rating) {
        const n = parseInt(rating, 10);
        if (!n || n < 1) return '';
        return `<span class="review-stars" title="${n} star${n === 1 ? '' : 's'}">${'‚òÖ'.repeat(n)}${'‚òÜ'.repeat(5-n)}</span>`;
      }
      const cards = processedG.map(r => {
        const dateStr = r.date
          ? new Date(r.date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })
          : '';
        const stars = renderStars(r.rating);
        return `
          <div class="review-card">
            <div class="review-header">
              <span>${escapeHtml(r.name || '')}</span>
              <span class="review-date">${dateStr}</span>
              ${stars ? `<span class="review-rating">${stars}</span>` : ''}
            </div>
            <div class="review-text">${escapeHtml(r.review || '')}</div>
          </div>
        `;
      }).join('');
      container.innerHTML = cards;
    } catch (error) {
      console.error('Failed to load GoogleReviews sheet data', error);
      container.innerHTML = '<p>Failed to load Google reviews.</p>';
    }
  });
  </script>

</body>
</html>
